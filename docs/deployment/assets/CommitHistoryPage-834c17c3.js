import{r as e,ab as t,c as n,u as i,az as o,e as a,b as r,S as l,d as s,C as c,R as d,A as m,_ as u,j as p,aA as f,ag as h,as as g,aB as v,aC as y,k as b}from"./index-77b4db63.js";import{u as C,T as _}from"./TourProvider-7be1086a.js";import{B as w}from"./Button-df935d27.js";import{B as k}from"./ButtonGroup-c5913e8c.js";import{p as N}from"./index-06bcf729.js";import{a as I}from"./ThemeProvider-cc165be1.js";import{T as V,i as S}from"./react-code-blocks.esm-48d86592.js";import{C as O}from"./Container-652355f0.js";import{R as M}from"./Row-55a0cdb3.js";import{C as B}from"./Col-6bd4c284.js";import"./extends-64d70faf.js";import"./setPrototypeOf-5f9718cf.js";const E=[{selector:"#History",content:"This is the your commit history timeline. You can view your committed maps and code here."},{selector:"#CommitSelector",content:"Switch between your map and code commits here."},{selector:"#viewBox",content:"This shows the map or the code you have committed"},{selector:"#CommitButton",content:"Click this button to load your commit into the Editor / Map Designer"}];var T={__esModule:!0,default:void 0},j=A(e),x=A(N),L=A(I);function A(e){return e&&e.__esModule?e:{default:e}}const D=({animate:e=!0,className:t="",layout:n="2-columns",lineColor:i="#FFF",children:o})=>("object"==typeof window&&document.documentElement.style.setProperty("--line-color",i),j.default.createElement("div",{className:(0,L.default)(t,"vertical-timeline",{"vertical-timeline--animate":e,"vertical-timeline--two-columns":"2-columns"===n,"vertical-timeline--one-column-left":"1-column"===n||"1-column-left"===n,"vertical-timeline--one-column-right":"1-column-right"===n})},o));D.propTypes={children:x.default.oneOfType([x.default.arrayOf(x.default.node),x.default.node]).isRequired,className:x.default.string,animate:x.default.bool,layout:x.default.oneOf(["1-column-left","1-column","2-columns","1-column-right"]),lineColor:x.default.string};var P=D;T.default=P;var R={};function H(){return H=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},H.apply(this,arguments)}function U(e,t){return(U=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var z=new Map,F=new WeakMap,$=0,J=void 0;function q(e){return Object.keys(e).sort().filter((function(t){return void 0!==e[t]})).map((function(t){return t+"_"+("root"===t?(n=e.root)?(F.has(n)||($+=1,F.set(n,$.toString())),F.get(n)):"0":e[t]);var n})).toString()}function W(e,t,n,i){if(void 0===n&&(n={}),void 0===i&&(i=J),void 0===window.IntersectionObserver&&void 0!==i){var o=e.getBoundingClientRect();return t(i,{isIntersecting:i,target:e,intersectionRatio:"number"==typeof n.threshold?n.threshold:0,time:0,boundingClientRect:o,intersectionRect:o,rootBounds:o}),function(){}}var a=function(e){var t=q(e),n=z.get(t);if(!n){var i,o=new Map,a=new IntersectionObserver((function(t){t.forEach((function(t){var n,a=t.isIntersecting&&i.some((function(e){return t.intersectionRatio>=e}));e.trackVisibility&&void 0===t.isVisible&&(t.isVisible=a),null==(n=o.get(t.target))||n.forEach((function(e){e(a,t)}))}))}),e);i=a.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),n={id:t,observer:a,elements:o},z.set(t,n)}return n}(n),r=a.id,l=a.observer,s=a.elements,c=s.get(e)||[];return s.has(e)||s.set(e,c),c.push(t),l.observe(e),function(){c.splice(c.indexOf(t),1),0===c.length&&(s.delete(e),l.unobserve(e)),0===s.size&&(l.disconnect(),z.delete(r))}}var G=["children","as","triggerOnce","threshold","root","rootMargin","onChange","skip","trackVisibility","delay","initialInView","fallbackInView"];function X(e){return"function"!=typeof e.children}var Y=function(t){var n,i;function o(e){var n;return(n=t.call(this,e)||this).node=null,n._unobserveCb=null,n.handleNode=function(e){n.node&&(n.unobserve(),e||n.props.triggerOnce||n.props.skip||n.setState({inView:!!n.props.initialInView,entry:void 0})),n.node=e||null,n.observeNode()},n.handleChange=function(e,t){e&&n.props.triggerOnce&&n.unobserve(),X(n.props)||n.setState({inView:e,entry:t}),n.props.onChange&&n.props.onChange(e,t)},n.state={inView:!!e.initialInView,entry:void 0},n}i=t,(n=o).prototype=Object.create(i.prototype),n.prototype.constructor=n,U(n,i);var a=o.prototype;return a.componentDidUpdate=function(e){e.rootMargin===this.props.rootMargin&&e.root===this.props.root&&e.threshold===this.props.threshold&&e.skip===this.props.skip&&e.trackVisibility===this.props.trackVisibility&&e.delay===this.props.delay||(this.unobserve(),this.observeNode())},a.componentWillUnmount=function(){this.unobserve(),this.node=null},a.observeNode=function(){if(this.node&&!this.props.skip){var e=this.props,t=e.threshold,n=e.root,i=e.rootMargin,o=e.trackVisibility,a=e.delay,r=e.fallbackInView;this._unobserveCb=W(this.node,this.handleChange,{threshold:t,root:n,rootMargin:i,trackVisibility:o,delay:a},r)}},a.unobserve=function(){this._unobserveCb&&(this._unobserveCb(),this._unobserveCb=null)},a.render=function(){if(!X(this.props)){var t=this.state,n=t.inView,i=t.entry;return this.props.children({inView:n,entry:i,ref:this.handleNode})}var o=this.props,a=o.children,r=o.as,l=function(e,t){if(null==e)return{};var n,i,o={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(o[n]=e[n]);return o}(o,G);return e.createElement(r||"div",H({ref:this.handleNode},l),a)},o}(e.Component);Y.displayName="InView",Y.defaultProps={threshold:0,triggerOnce:!1,initialInView:!1};const K=t(Object.freeze(Object.defineProperty({__proto__:null,InView:Y,default:Y,defaultFallbackInView:function(e){J=e},observe:W,useInView:function(t){var n=void 0===t?{}:t,i=n.threshold,o=n.delay,a=n.trackVisibility,r=n.rootMargin,l=n.root,s=n.triggerOnce,c=n.skip,d=n.initialInView,m=n.fallbackInView,u=e.useRef(),p=e.useState({inView:!!d}),f=p[0],h=p[1],g=e.useCallback((function(e){void 0!==u.current&&(u.current(),u.current=void 0),c||e&&(u.current=W(e,(function(e,t){h({inView:e,entry:t}),t.isIntersecting&&s&&u.current&&(u.current(),u.current=void 0)}),{root:l,rootMargin:r,threshold:i,trackVisibility:a,delay:o},m))}),[Array.isArray(i)?i.toString():i,l,r,s,c,a,m,o]);e.useEffect((function(){u.current||!f.entry||s||c||h({inView:!!d})}));var v=[g,f.inView,f.entry];return v.ref=v[0],v.inView=v[1],v.entry=v[2],v}},Symbol.toStringTag,{value:"Module"})));R.__esModule=!0,R.default=void 0;var Q=ne(e),Z=ne(N),ee=ne(I),te=K;function ne(e){return e&&e.__esModule?e:{default:e}}const ie=({children:e="",className:t="",contentArrowStyle:n=null,contentStyle:i=null,date:o="",dateClassName:a="",icon:r=null,iconClassName:l="",iconOnClick:s=null,onTimelineElementClick:c=null,iconStyle:d=null,id:m="",position:u="",style:p=null,textClassName:f="",intersectionObserverProps:h={rootMargin:"0px 0px -40px 0px",triggerOnce:!0},visible:g=!1})=>Q.default.createElement(te.InView,h,(({inView:h,ref:v})=>Q.default.createElement("div",{ref:v,id:m,className:(0,ee.default)(t,"vertical-timeline-element",{"vertical-timeline-element--left":"left"===u,"vertical-timeline-element--right":"right"===u,"vertical-timeline-element--no-children":""===e}),style:p},Q.default.createElement(Q.default.Fragment,null,Q.default.createElement("span",{style:d,onClick:s,className:(0,ee.default)(l,"vertical-timeline-element-icon",{"bounce-in":h||g,"is-hidden":!(h||g)})},r),Q.default.createElement("div",{style:i,onClick:c,className:(0,ee.default)(f,"vertical-timeline-element-content",{"bounce-in":h||g,"is-hidden":!(h||g)})},Q.default.createElement("div",{style:n,className:"vertical-timeline-element-content-arrow"}),e,Q.default.createElement("span",{className:(0,ee.default)(a,"vertical-timeline-element-date")},o))))));ie.propTypes={children:Z.default.oneOfType([Z.default.arrayOf(Z.default.node),Z.default.node]),className:Z.default.string,contentArrowStyle:Z.default.shape({}),contentStyle:Z.default.shape({}),date:Z.default.node,dateClassName:Z.default.string,icon:Z.default.element,iconClassName:Z.default.string,iconStyle:Z.default.shape({}),iconOnClick:Z.default.func,onTimelineElementClick:Z.default.func,id:Z.default.string,position:Z.default.string,style:Z.default.shape({}),textClassName:Z.default.string,visible:Z.default.bool,intersectionObserverProps:Z.default.shape({root:Z.default.object,rootMargin:Z.default.string,threshold:Z.default.number,triggerOnce:Z.default.bool})};var oe=ie;R.default=oe;var ae={VerticalTimeline:T.default,VerticalTimelineElement:R.default};function re(t){const i={background:"#1E3821",color:"#fff"},[o,a]=e.useState("0");return n(ae.VerticalTimeline,{layout:"1-column-left",lineColor:"#EAEAEA",children:t.commitHistoryDetails&&t.commitHistoryDetails.length>0?t.commitHistoryDetails.map((e=>{return n(ae.VerticalTimelineElement,{className:"vertical-timeline-element--work",contentStyle:{background:"rgba(26, 26, 26, 0.7)",color:"#fff"},date:(r=e.createdAt.toString(),`${r.substring(8,10)}-${r.substring(5,7)}-${r.substring(0,4)}`),iconStyle:o==e.id?i:{background:"#444444",color:"#444444"},onTimelineElementClick:()=>{a(e.id),t.commitID(e.id)},children:n("h6",{className:"vertical-timeline-element-title",children:e.message})},e.id.toString());var r})):n("h1",{className:"noCommitStyle",children:"No Commits available"})})}const le={historyMain:"_historyMain_12mol_1",viewContainer:"_viewContainer_12mol_10",codeView:"_codeView_12mol_14",buttonContainer:"_buttonContainer_12mol_22",whiteButton:"_whiteButton_12mol_29",darkButton:"_darkButton_12mol_45",codeBox:"_codeBox_12mol_71",mapBox:"_mapBox_12mol_82",select:"_select_12mol_94",selectButton:"_selectButton_12mol_99",completeTimeline:"_completeTimeline_12mol_120",noCommitDataHeader:"_noCommitDataHeader_12mol_133",mapImg:"_mapImg_12mol_151",mapLoad:"_mapLoad_12mol_159"};function se(e){return n(V,{text:e.code,language:e.codeLang,showLineNumbers:""!=e.code,theme:S})}function ce(){const[t,b]=e.useState("Code"),[_,N]=e.useState([]),[I,V]=e.useState([]),[S,E]=e.useState(!1),[T,j]=e.useState(!1),[x,L]=e.useState(""),[A,D]=e.useState(""),[P,R]=e.useState({map:[],mapImg:""}),[H,U]=e.useState(""),z=i(o),F=a(),$=r(),J=new l(s),q=new c(s),{setIsOpen:W}=C();e.useEffect((()=>{setTimeout((()=>{q.getCurrentUser().then((e=>{!1===e.isTutorialComplete&&4==e.tutorialLevel&&W(!0)}))}),200);new d(s).getCodeRevisions().then((e=>{j(!0),N(e)})).catch((e=>{e instanceof m&&u.error(e.message)})),J.getMapRevisions().then((e=>{E(!0),V(e)})).catch((e=>{e instanceof m&&u.error(e.message)}))}),[]);return p(O,{fluid:!0,className:le.historyMain,children:[n("div",{className:le.buttonContainer,children:n("div",{className:le.codeMapButton,children:p(k,{id:"CommitSelector",children:[n(w,{className:"Map"==t?le.whiteButton:le.darkButton,onClick:()=>{b("Map")},variant:"outline-light",children:"MAP"}),n(w,{variant:"outline-light",className:"Code"==t?le.whiteButton:le.darkButton,onClick:()=>{b("Code")},children:"CODE"})]})})}),p(M,{className:le.viewContainer,children:[n(B,{lg:"4",style:{marginLeft:"5%"},children:n("div",{className:le.completeTimeline,id:"History",children:T&&"Code"==t||S&&"Map"==t?n(re,{commitID:e=>{R({map:P.map,mapImg:""}),_.forEach((t=>{t.id===e&&(L(t.code),D(t.language.toLowerCase()),U(t.message))})),I.forEach((t=>{var n;t.id==e&&(U(t.message),z.some((t=>t.CommitId==e))?R({map:JSON.parse(t.map),mapImg:null==(n=z.find((t=>t.CommitId===e)))?void 0:n.Image}):J.getMapByCommitID(t.id).then((n=>{R({map:JSON.parse(t.map),mapImg:n.mapImage}),$(f({CommitId:e,Image:n.mapImage}))})).catch((e=>{e instanceof m&&u.error(e.message)})))}))},commitHistoryDetails:"Code"===t?_:I,SelectedButton:t}):n("h1",{className:le.noCommitDataHeader,children:"Loading..."})})}),p(B,{lg:"9",className:le.codeView,id:"viewBox",children:[n("div",{className:"Code"==t?le.codeBox:le.mapBox,children:"Code"==t?n(se,{code:x,codeLang:A}):""!=P.mapImg?n("img",{className:le.mapImg,src:P.mapImg}):n("div",{className:le.mapLoad,children:"Map image not found"})}),n("div",{className:le.select,children:n(w,{className:le.selectButton,size:"lg",onClick:()=>{if("Code"==t&&""!=x){switch($(h({currentUserLanguage:"cpp"===A?"c_cpp":A,currentUserCode:x})),$(g("cpp"===A?"c_cpp":A)),A){case"cpp":localStorage.setItem("languageChose","C++");break;case"python":localStorage.setItem("languageChose","Python");break;case"java":localStorage.setItem("languageChose","Java");break;default:$(g("c_cpp"))}v.success(` Loaded commit - ${H}`),F("/dashboard",{replace:!0})}else"Map"==t&&""!=P.mapImg&&0!==P.map.length&&($(y(P)),v.success(` Loaded commit - ${H}`),F("/mapdesigner",{replace:!0}))},variant:"outline-light",id:"CommitButton",children:"LOAD COMMIT"})})]})]})]})}const de=()=>{const e=new c(s),t=i(b),o=a();return n(_,{setOpened:n=>{!1===n&&e.updateCurrentUser({name:t.name,country:t.country,college:t.college,updateTutorialLevel:"NEXT"}).then((()=>{o("/battletv",{replace:!0})})).catch((e=>{e instanceof m&&u.error(e.message)}))},steps:E,children:n(ce,{})})};export{de as default};
